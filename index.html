<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="keywords" content="hromosvody, chaos, koƒçka, koƒçky, koƒçek, ƒçlovƒõk, v√Ωbuch, dr≈æ ctrl, kreslete, rm -rf, 367sk, interaktivn√≠ hra, z√°bava, fyzika, hackersk√° hra, absurdn√≠ web">
    <meta name="author" content="hromosvody.club">
    <meta name="robots" content="index, follow">
    <meta name="language" content="Czech">
    <meta name="revisit-after" content="7 days">
    
    <link rel="canonical" href="https://hromosvody.club/index.html">
    <link rel="alternate" hreflang="cs" href="https://hromosvody.club/index.html">
    <link rel="alternate" hreflang="x-default" href="https://hromosvody.club/index.html">

    <meta property="og:type" content="website">
    <meta property="og:url" content="https://hromosvody.club">
    <meta property="og:title" content="‚ö° hromosvody.club - TOTAL TRASH EDITION ‚ö°">
    <meta property="og:description" content="Interaktivn√≠ chaos - tahej koƒçky, hraj si s fyzikou a vzor z√°bavu. Fyzick√© objekty padaj√≠, kresl√≠≈° a se≈° souƒç√°st√≠ pekla.">
    <meta property="og:locale" content="cs_CZ">
    <meta property="og:site_name" content="hromosvody.club">
    <meta property="og:image" content="https://hromosvody.club/og-image.png">
    
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="‚ö° hromosvody.club - TOTAL TRASH EDITION ‚ö°">
    <meta name="twitter:description" content="Interaktivn√≠ webov√° str√°nka pln√° chaosu a padaj√≠c√≠ch koƒçek. Zahraj si, kresli a vymrzni!">
    <meta name="twitter:image" content="https://hromosvody.club/og-image.png">
    <meta name="twitter:site" content="@hromosvody">
    <meta name="twitter:creator" content="@hromosvody">
    
    <link rel="icon" type="image/png" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='75' font-size='75'>‚ö°</text></svg>">
    <link rel="shortcut icon" type="image/png" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='75' font-size='75'>‚ö°</text></svg>">
    
        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "WebApplication",
            "name": "hromosvody.club - TOTAL TRASH EDITION",
            "description": "Interaktivn√≠ webov√° aplikace pln√° chaosu, padaj√≠c√≠ch koƒçek a absurdn√≠ho humoru",
            "url": "https://hromosvody.club",
            "applicationCategory": "GameApplication",
            "inLanguage": "cs-CZ",
            "browserRequirements": "Requires JavaScript",
            "offers": {
                "@type": "Offer",
                "price": "0",
                "priceCurrency": "CZK"
            }
        }
        </script>

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "WebSite",
            "name": "hromosvody.club",
            "url": "https://hromosvody.club",
            "inLanguage": "cs-CZ",
            "potentialAction": {
                "@type": "SearchAction",
                "target": "https://hromosvody.club/?q={search_term_string}",
                "query-input": "required name=search_term_string"
            }
        }
        </script>

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Product",
            "name": "TOTAL TRASH EDITION Chaos Pack",
            "image": "https://hromosvody.club/og-image.png",
            "description": "Interaktivn√≠ chaos s koƒçkami, v√Ωbuchem a CTRL kreslete - z√°bava zdarma",
            "sku": "HTE-001",
            "brand": {"@type": "Brand", "name": "hromosvody"},
            "offers": {"@type": "Offer", "price": "0", "priceCurrency": "CZK", "availability": "https://schema.org/InStock", "itemCondition": "https://schema.org/NewCondition"},
            "aggregateRating": {"@type": "AggregateRating", "ratingValue": "4.8", "reviewCount": "128"},
            "review": {"@type": "Review", "reviewBody": "Nejv√≠c chaotick√° koƒçiƒç√≠ hra.", "reviewRating": {"@type": "Rating", "ratingValue": "5"}, "author": {"@type": "Person", "name": "Random ƒålovƒõk"}}
        }
        </script>

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Event",
            "name": "V√Ωbuch koƒçek live stream",
            "eventAttendanceMode": "https://schema.org/OnlineEventAttendanceMode",
            "eventStatus": "https://schema.org/EventScheduled",
            "startDate": "2026-02-01T20:00:00+01:00",
            "endDate": "2026-02-01T21:00:00+01:00",
            "location": {
                "@type": "Place",
                "name": "Hromosvody Club Live",
                "address": {
                    "@type": "PostalAddress",
                    "addressCountry": "CZ"
                }
            },
            "organizer": {
                "@type": "Organization",
                "name": "hromosvody.club",
                "url": "https://hromosvody.club"
            }
        }
        </script>

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "BreadcrumbList",
            "itemListElement": [
                {
                    "@type": "ListItem",
                    "position": 1,
                    "name": "Dom≈Ø",
                    "item": "https://hromosvody.club/index.html"
                }
            ]
        }
        </script>
    <title>‚ö° hromosvody.club - Chaos koƒçky v√Ωbuch CTRL</title>
    <meta name="description" content="hromosvody.club TOTAL TRASH EDITION - koƒçka, koƒçek, ƒçlovƒõk, v√Ωbuch, dr≈æ CTRL a kreslete, rm -rf 367sk: interaktivn√≠ chaos pln√Ω koƒçek, hackersk√Ωch her">
    
    <style>
        body {
            background: #ff00ff;
            background-image: repeating-linear-gradient(45deg, #f0f, #f0f 10px, #0ff 10px, #0ff 20px);
            font-family: "Comic Sans MS", cursive;
            margin: 0;
            overflow: hidden;
            height: 100vh;
            width: 100vw;
            cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" style="font-size:20px"><text y="15">‚ö°</text></svg>'), auto;
        }

        #content-layer {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 10;
            overflow-y: auto;
            pointer-events: auto;
        }

        .container {
            display: flex; flex-wrap: wrap; justify-content: center; gap: 20px; padding: 20px; padding-bottom: 150px;
        }

        .frame { 
            border: 10px ridge #ff0000; background: #246; color: #fda; 
            padding: 15px; width: 320px; box-shadow: 15px 15px 0px rgba(0,0,0,0.5);
            margin-bottom: 20px; position: relative;
            transition: transform 0.2s;
        }
        .frame:hover { transform: scale(1.02) rotate(1deg); z-index: 20; }
        
        .pigborder { border-color: #f90; border-style: double; }
        .bluborder { border-color: #00f; border-style: dashed; }
        
        button { background: yellow; cursor: pointer; border: 4px outset white; margin: 5px; font-size: 16px; font-weight: bold; }
        button:hover { background: red; color: white; border-style: inset; }
        input, textarea { background: black; color: #0f0; border: 2px solid cyan; width: 90%; font-family: monospace; }

        h2 { background: black; color: yellow; display: inline-block; padding: 5px; transform: skew(-10deg); }

        .phys-obj {
            position: absolute; z-index: 1000; cursor: grab; touch-action: none; will-change: transform, opacity;
        }
        .phys-obj.dragging { cursor: grabbing; filter: hue-rotate(90deg); z-index: 10000; }

        .blink { animation: blinker 0.2s linear infinite; }
        @keyframes blinker { 50% { opacity: 0; } }
        
        .runaway { position: absolute; transition: 0.1s; }

        .paint-dot { position: absolute; width: 10px; height: 10px; border-radius: 50%; pointer-events: none; z-index: 5; }

        #jumpscare-overlay {
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
            display: none; z-index: 99999999; background-size: cover; background-position: center;
        }
        .strobe-active { animation: strobe 0.05s infinite !important; }
        @keyframes strobe { 0% { background-color: red; } 50% { background-color: white; } 100% { background-color: blue; } }

        .console-box { height: 100px; overflow-y: scroll; background: #000; color: lime; font-size: 12px; border: 1px inset gray; text-align: left; }

        /* Chat styles kept simple for length */
        #chat-popup { position: fixed; bottom: 20px; right: 20px; width: 350px; height: 500px; background: black; border: 3px solid cyan; z-index: 9999999; display: flex; flex-direction: column; box-shadow: 0 0 20px cyan; font-family: monospace; }
        #chat-header { background: cyan; color: black; padding: 10px; font-weight: bold; display: flex; justify-content: space-between; align-items: center; }
        #chat-close { cursor: pointer; font-weight: bold; font-size: 20px; }
        #chat-login { padding: 10px; display: flex; flex-direction: column; gap: 5px; }
        #chat-messages { flex: 1; overflow-y: auto; padding: 10px; border-bottom: 2px solid cyan; font-size: 12px; color: lime; }
        .chat-message { margin: 5px 0; word-wrap: break-word; }
        .chat-message-user { color: yellow; font-weight: bold; }
        #chat-input-area { display: flex; gap: 5px; padding: 10px; }
        .chat-username-info { color: cyan; font-size: 11px; padding: 5px; border-bottom: 1px solid cyan; }
    </style>
</head>
<body onload="initAll()">

    <div id="jumpscare-overlay"></div>

    <div id="chat-popup">
        <div id="chat-header">
            üí¨ LIVE CHAT
            <span id="chat-close" onclick="toggleChat()">‚úï</span>
        </div>
        <div id="chat-login" style="display: none;">
            <input type="text" id="username-input" placeholder="Zadej username..." maxlength="20">
            <button onclick="loginChat()">LOGIN</button>
        </div>
        <div class="chat-username-info" id="chat-username-info" style="display: none;"></div>
        <div id="chat-messages"></div>
        <div id="chat-input-area" style="display: none;">
            <input type="text" id="chat-msg-input" placeholder="Zpr√°va..." maxlength="500">
            <button onclick="sendChatMessage()">SEND</button>
        </div>
    </div>

    <div style="position: fixed; top: 0; width: 100%; background: blue; color: white; z-index: 5000; border-bottom: 5px solid lime; padding: 5px; display: flex; justify-content: space-between;">
        <span>KOƒåEK: <b id="count">0</b></span>
        <button onclick="explodeAll()">üí£ V√ùBUCH</button>
        <button onclick="spawnCat()">üê± +1 KOƒåKA</button>
        <span>DR≈Ω <b>CTRL</b> A KRESLETE!</span>
    </div>

    <div id="content-layer" role="main" aria-label="Hlavn√≠ obsah aplikace">
        <br><br><br>
        <header style="background: black; padding: 20px; border: 10px dashed gold; text-align: center; transform: rotate(-1deg);" role="banner">
            <h1 class="blink" style="font-size: 50px; color: magenta; text-shadow: 3px 3px lime;">‚ö° CHAOS KOƒåEK & ƒåLOVƒöK CTRL KRESLETE ‚ö°</h1>
            <marquee style="font-size: 30px; color: white; background: red; font-weight: bold;" aria-label="Uv√≠tac√≠ zpr√°va">
                V√çTEJTE V DIGIT√ÅLN√çM SKLADI≈†TI ‚ö° KOƒåKY PROPADAJ√ç DO PEKLA ‚ö° KLIKNE≈† A NEV√ç≈† ‚ö°
            </marquee>
        </header>

        <div class="container" role="region" aria-label="Interaktivn√≠ hern√≠ prvky">
            
            <div class="frame pigborder">
                <h2>üëÆ CELNICE</h2>
                <p>M√°te nƒõco k proclen√≠?</p>
                <button onclick="priznal()">ANO</button>
                <button onclick="alert('POKUTA 367 Sk!'); priznal()">NE</button>
            </div>

            <div class="frame bluborder">
                <h2>üî¢ PRVOƒå√çSLA</h2>
                <input type="number" id="cislo" placeholder="Zadej ƒç√≠slo...">
                <button onclick="checkno()">ANAL√ùZA</button>
            </div>

            <div class="frame" style="height: 150px;">
                <h2>ü§ñ PAST NA ROBOTY</h2>
                <p>Klikni, pokud jsi ƒçlovƒõk:</p>
                <button id="runaway-btn" onmouseover="moveBtn(this)">JSEM ƒåLOVƒöK</button>
            </div>

            <div class="frame" style="background: #100;">
                <h3>üî• KRB</h3>
                <textarea id="krb" rows="4">MAGICK√ù OHE≈á MƒöN√ç P√çSMENA...</textarea>
                <button onclick="toggleKrb()">P≈òILO≈ΩIT</button>
            </div>

            <div class="frame pigborder">
                <h2>ü•ê ROHL√çKOMƒöR</h2>
                <p>Mzda vs Rohl√≠k (3 Kƒç)</p>
                <input id="money" type="number" placeholder="Tvoje v√Ωplata...">
                <button onclick="calcRohlik()">SPOƒå√çTAT</button>
                <h3 id="rohlik-res">0 ks</h3>
            </div>

            <div class="frame" style="background: black; border-color: lime;">
                <h3>üíª HACKER ZONE</h3>
                <div id="terminal" class="console-box">System booting...<br></div>
            </div>

            <div class="frame bluborder">
                <h3>üí¨ FAKE CHAT</h3>
                <div id="chat" class="console-box" style="background: white; color: black;"></div>
            </div>

            <div class="frame" style="background: darkred;">
                <h2 class="blink">‚ö†Ô∏è VIRUS ZDARMA</h2>
                <p>Stahov√°n√≠: <span id="virus-pct">0%</span></p>
                <div style="width: 100%; background: black; height: 20px;">
                    <div id="virus-bar" style="width: 0%; background: lime; height: 100%;"></div>
                </div>
                <button onclick="startVirus()">ST√ÅHNOUT</button>
            </div>

            <div class="frame">
                <h2>üç™ COOKIES</h2>
                <p>Souhlas√≠te se v≈°√≠m?</p>
                <div id="cookie-area">
                    <button onclick="cloneMe(this)">SOUHLAS√çM</button>
                </div>
            </div>

            <div class="frame pigborder">
                <h2>üì± PHONE NUKE</h2>
                <button onclick="nuke()">ODP√ÅLIT MOBIL</button>
            </div>

            <div class="frame" style="background:coral; padding: 20px; border-radius: 10px; text-align: center;">
                <h2>üé∂ PROPALOVAƒå U≈†√ç</h2>
                <p id="song-name" style="font-weight: bold; min-height: 1.2em;">Vyber si ≈°vestku!</p>
                <button onclick="music()">P≈òEPNI MUZIƒåKU</button>
                <div style="margin-top: 12px;">
                    <label for="volume">Hlasitos≈•: </label>
                    <input type="range" id="volume" min="0" max="1" step="0.1" value="0.5" oninput="changeVolume(this.value)">
                </div>
            </div>

            <footer style="width: 100%; text-align: center; color: white; background: black; padding: 20px;">
                <p>Tady je konec str√°nky. Koƒçky padaj√≠ d√°l. <br> 367 FOREVER.</p>
            </footer>
        </div>
    </div>

    <script>
    // --- Music player START ---
        const playlist = [
            { name: "Pohodov√Ω Jazz", url: "hudba/jazz.mp3" },
            { name: "Po≈ô√°dnej Rock", url: "hudba/rock.mp3" },
            { name: "Lo-fi Beats", url: "hudba/lofi.mp3" },
        ];

        const audio = new Audio();
        const songDisplay = document.getElementById('song-name');

        audio.volume = 0.5;

        function music() {
            // Random pick from object
            const randomIndex = Math.floor(Math.random() * playlist.length);
            const selectedSong = playlist[randomIndex];

            // What music
            audio.src = selectedSong.url;

            audio.loop = true; 

            if(songDisplay) {
                songDisplay.innerText = "Pr√°vƒõ hraje: " + selectedSong.name;
            }

            // Start
            audio.play().catch(error => {
                console.log("Chyba p≈ôi p≈ôehr√°v√°n√≠: Pravdƒõpodobnƒõ ≈°patn√° cesta k souboru.");
            });
        }

        // Change volume
        function changeVolume(val) {
            audio.volume = val;
        }
    // --- Music player END ---

        const gravity = 0.5;
        const friction = 0.99;
        const bounce = 0.6;
        let objects = [];
        let draggedObj = null;
        let lastX=0, lastY=0, vX=0, vY=0;

        class PhysObject {
            constructor(el, x, y) {
                this.el = el;
                this.x = x; this.y = y;
                this.vx = (Math.random()-0.5)*15; this.vy = (Math.random()-0.5)*15;
                this.w = 100; this.h = 100;
                this.ang = 0; this.vAng = (Math.random()-0.5);
                this.groundTime = 0;
                this.dragging = false;
                
                document.body.appendChild(this.el);
                this.el.addEventListener('mousedown', (e) => startDrag(e, this));
                this.el.onload = () => { this.w = this.el.width; this.h = this.el.height; }
            }
            update() {
                if(this.dragging) {
                    this.vx=0; this.vy=0; this.groundTime=0; this.el.style.opacity=1; return;
                }
                
                this.vy += gravity;
                this.x += this.vx; this.y += this.vy; this.ang += this.vAng;

                if(this.x < 0) { this.x=0; this.vx *= -bounce; }
                if(this.x+this.w > window.innerWidth) { this.x=window.innerWidth-this.w; this.vx *= -bounce; }

                if(this.y+this.h > window.innerHeight) {
                    if(this.groundTime < 100) {
                        this.y = window.innerHeight-this.h;
                        this.vy *= -bounce;
                        this.vx *= 0.8;
                        this.groundTime++;
                        this.el.style.opacity = 1 - (this.groundTime/100);
                        this.el.style.filter = `hue-rotate(${this.groundTime*2}deg)`;
                    }
                } else {
                    if(this.groundTime < 100) { this.groundTime=0; this.el.style.opacity=1; }
                }

                if(this.y > window.innerHeight + 200) {
                    this.y = -200; this.x = Math.random()*(window.innerWidth-100);
                    this.vx=0; this.vy=0; this.groundTime=0;
                    this.el.style.opacity=1; this.el.style.filter="none";
                }

                this.el.style.transform = `translate(${this.x}px, ${this.y}px) rotate(${this.ang}deg)`;
            }
        }

        function physLoop() {
            objects.forEach(o => o.update());
            requestAnimationFrame(physLoop);
        }

        function startDrag(e, o) { 
            e.preventDefault(); 
            draggedObj=o; 
            o.dragging=true; 
            o.el.classList.add('dragging');
            o.offX = e.clientX-o.x; 
            o.offY=e.clientY-o.y; 
        }
        document.addEventListener('mousemove', e => {
            vX = e.clientX-lastX; 
            vY = e.clientY-lastY;
            
            if(draggedObj) { 
                draggedObj.x = e.clientX-draggedObj.offX; 
                draggedObj.y = e.clientY-draggedObj.offY;
                draggedObj.el.style.transform = `translate(${draggedObj.x}px, ${draggedObj.y}px) rotate(${draggedObj.ang}deg)`;
            }
            lastX=e.clientX; 
            lastY=e.clientY;
            if(e.ctrlKey) drawDot(e.clientX, e.clientY);
        });
        document.addEventListener('mouseup', () => {
            if(draggedObj) { 
                draggedObj.vx=vX*1.5; 
                draggedObj.vy=vY*1.5; 
                draggedObj.dragging=false; 
                draggedObj.el.classList.remove('dragging');
                draggedObj=null; 
            }
        });

        function spawnCat() {
            let img = document.createElement('img');
            img.src = `https://cataas.com/cat?t=${Math.random()}`;
            img.alt = 'Padaj√≠c√≠ koƒçka';
            img.className = 'phys-obj';
            img.width = Math.random()*80+60;
            objects.push(new PhysObject(img, Math.random()*window.innerWidth, -150));
            document.getElementById('count').innerText = objects.length;
        }

        function explodeAll() {
            objects.forEach(o => { o.vy = -30; o.vx = (Math.random()-0.5)*50; o.groundTime=0; o.el.style.opacity=1; });
        }

        function priznal() { alert("Zapla≈• 367 zlat√Ωch!"); spawnEmoji('üí∞'); }
        
        const isPrime = n => {
            if(n<2) return false;
            for(let i=2; i*i<=n; i++) if(n%i===0) return false;
            return true;
        }
        function checkno() { 
            let v = document.getElementById('cislo').value;
            alert(v + (isPrime(v) ? " JE PRVOƒå√çSLO! ‚ö°" : " JE SLO≈ΩEN√â! üí©"));
            if(isPrime(v)) spawnEmoji('üî¢');
        }

        function moveBtn(btn) {
            btn.style.position = 'absolute';
            btn.style.top = Math.random()*100 + 'px';
            btn.style.left = Math.random()*200 + 'px';
        }

        let krbInt;
        function toggleKrb() {
            if(krbInt) { clearInterval(krbInt); krbInt=null; }
            else { 
                krbInt = setInterval(() => {
                    let k = document.getElementById('krb');
                    k.style.color = `hsl(${Math.random()*50}, 100%, 50%)`;
                    k.value = k.value.split('').map(c => Math.random()>0.9 ? String.fromCharCode(c.charCodeAt(0)+1) : c).join('');
                }, 100);
            }
        }

        function calcRohlik() {
            let m = document.getElementById('money').value;
            document.getElementById('rohlik-res').innerText = Math.floor(m/3) + " Rohl√≠k≈Ø";
            spawnEmoji('ü•ê');
        }

        function nuke() {
            document.body.style.filter = "invert(1) contrast(5)";
            setTimeout(() => document.body.style.filter = "none", 500);
            alert("‚ö†Ô∏è SYSTEM FAILURE 367 ‚ö†Ô∏è");
        }

        function cloneMe(btn) {
            let clone = btn.cloneNode(true);
            clone.style.position = 'absolute';
            clone.style.left = Math.random()*200+'px';
            clone.style.top = Math.random()*200+'px';
            document.getElementById('cookie-area').appendChild(clone);
        }

        function drawDot(x, y) {
            let d = document.createElement('div');
            d.className = 'paint-dot';
            d.style.left = x+'px'; d.style.top = y+'px';
            d.style.background = `hsl(${Math.random()*360}, 100%, 50%)`;
            document.body.appendChild(d);
            setTimeout(() => d.remove(), 5000);
        }

        function startVirus() {
            let w = 0;
            let bar = document.getElementById('virus-bar');
            let pct = document.getElementById('virus-pct');
            let i = setInterval(() => {
                w += Math.random()*5;
                if(w>100) { w=100; clearInterval(i); alert("VIRUS √öSPƒö≈†Nƒö NAINSTALOV√ÅN!"); spawnCat(); }
                bar.style.width = w+'%';
                pct.innerText = Math.floor(w)+'%';
            }, 100);
        }

        function autoStuff() {
            setInterval(() => {
                let t = document.getElementById('terminal');
                let lines = ["Hacking NSA...", "Downloading cats...", "rm -rf /", "367 logic loaded", "Error 404"];
                t.innerHTML += lines[Math.floor(Math.random()*lines.length)] + "<br>";
                t.scrollTop = t.scrollHeight;
            }, 500);

            setInterval(() => {
                let c = document.getElementById('chat');
                let msgs = ["M≈àau", "Kde je 384?", "Lol", "Admin je b≈Øh", "Klikni na to!"];
                c.innerHTML += `<b style="color:blue">User${Math.floor(Math.random()*99)}:</b> ${msgs[Math.floor(Math.random()*msgs.length)]}<br>`;
                c.scrollTop = c.scrollHeight;
            }, 1500);

            scheduleJumpscare();
        }

        function scheduleJumpscare() { setTimeout(doJumpscare, Math.random()*30000+30000); }
        function doJumpscare() {
            let o = document.getElementById('jumpscare-overlay');
            o.style.backgroundImage = `url('https://cataas.com/cat/angry?t=${Date.now()}')`;
            o.style.display='block'; o.className='strobe-active';
            setTimeout(() => { o.style.display='none'; o.className=''; scheduleJumpscare(); }, 2000);
        }

        function spawnEmoji(char) {
            let d = document.createElement('div');
            d.innerText = char; d.className = 'phys-obj';
            d.style.fontSize = '40px';
            objects.push(new PhysObject(d, Math.random()*window.innerWidth, -100));
        }

        function initAll() {
            physLoop();
            autoStuff();
            for(let i=0; i<5; i++) setTimeout(spawnCat, i*300);
            setInterval(spawnCat, 2500);
            initChat();
        }

        /* --- REAL CHAT LOGIC --- */
        let chatToken = localStorage.getItem('chat_token');
        let chatUsername = localStorage.getItem('chat_username');
        let lastServerStartTime = localStorage.getItem('server_start_time');

        function initChat() {
            fetch('/api/chat/session')
            .then(r => r.json())
            .then(session => {
                if (lastServerStartTime && lastServerStartTime !== String(session.startTime)) {
                    localStorage.removeItem('chat_token');
                    localStorage.removeItem('chat_username');
                    chatToken = null;
                    chatUsername = null;
                }
                localStorage.setItem('server_start_time', session.startTime);
                
                if (chatToken && chatUsername) {
                    showChatLoggedIn();
                    loadChatMessages();
                    setInterval(loadChatMessages, 2000);
                } else {
                    showChatLogin();
                }
            })
            .catch(e => {
                console.log('Session check failed:', e);
                showChatLogin();
            });
        }

        function showChatLogin() {
            document.getElementById('chat-login').style.display = 'flex';
            document.getElementById('chat-messages').innerHTML = '<div style="color: cyan; padding: 10px; text-align: center;">P≈ôihla≈° se abys chatoval!</div>';
            document.getElementById('chat-input-area').style.display = 'none';
            document.getElementById('chat-username-info').style.display = 'none';
        }

        function showChatLoggedIn() {
            document.getElementById('chat-login').style.display = 'none';
            document.getElementById('chat-input-area').style.display = 'flex';
            document.getElementById('chat-username-info').style.display = 'block';
            document.getElementById('chat-username-info').innerText = `üë§ ${chatUsername}`;
        }

        function loginChat() {
            const username = document.getElementById('username-input').value.trim();
            if (!username) { alert('Username nem≈Ø≈æe b√Ωt pr√°zdn√Ω!'); return; }

            fetch('/api/chat/register', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ username })
            })
            .then(r => r.json())
            .then(data => {
                if (data.error) { alert('Chyba: ' + data.error); return; }
                localStorage.setItem('chat_token', data.token);
                localStorage.setItem('chat_username', data.username);
                chatToken = data.token;
                chatUsername = data.username;
                showChatLoggedIn();
                loadChatMessages();
                setInterval(loadChatMessages, 2000);
            })
            .catch(e => alert('Chyba: ' + e));
        }

        function loadChatMessages() {
            fetch('/api/chat/messages')
            .then(r => r.json())
            .then(messages => {
                const box = document.getElementById('chat-messages');
                box.innerHTML = '';
                messages.forEach(m => {
                    const msgDiv = document.createElement('div');
                    msgDiv.className = 'chat-message';
                    const userSpan = document.createElement('span');
                    userSpan.className = 'chat-message-user';
                    userSpan.textContent = m.username;
                    msgDiv.appendChild(userSpan);
                    msgDiv.appendChild(document.createTextNode(': ' + m.text));
                    box.appendChild(msgDiv);
                });
                box.scrollTop = box.scrollHeight;
            })
            .catch(e => console.log('Chat load error:', e));
        }

        function sendChatMessage() {
            const text = document.getElementById('chat-msg-input').value.trim();
            if (!text || !chatToken) return;

            fetch('/api/chat/send', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${chatToken}` },
                body: JSON.stringify({ text })
            })
            .then(r => r.json())
            .then(() => {
                document.getElementById('chat-msg-input').value = '';
                loadChatMessages();
            })
            .catch(e => console.log('Send error:', e));
        }

        function toggleChat() {
            const popup = document.getElementById('chat-popup');
            popup.style.display = popup.style.display === 'none' ? 'flex' : 'none';
        }

        document.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && document.activeElement.id === 'chat-msg-input') {
                sendChatMessage();
            }
        });
    </script>
</body>
</html>
